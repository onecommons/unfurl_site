
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    
    <title>Eval Expressions &#8212; Unfurl Documentation</title>

    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" href="_static/bootstrap-4.3.1-dist/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinxbootstrap4.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/bootstrap-4.3.1-dist/js/bootstrap.min.js"></script>
    <script src="_static/sphinxbootstrap4.js"></script>
    <link rel="shortcut icon" href="_static/favicon32.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Command Line" href="cli.html" />
    <link rel="prev" title="YAML Merge directives" href="processing.html" /> 
  </head><body>
  <nav class="navbar navbar-expand-md  fixed-top navbar-dark bg-dark flex-wrap">
    <button class="navbar-toggler ml-auto py-2" type="button" data-toggle="collapse" data-target="#exCollapsingNavbar2">
      &#9776;
    </button>
      <div class="navbar-collapse collapse" id="exCollapsingNavbar2">
           <a class="navbar-brand py-1" href="index.html">
              <img class="logo" src="_static/unfurl_logo.svg" alt="Unfurl"/>
          </a>
          <ul class="navbar-nav mr-auto">
          
              <li class="nav-item dropdown d-none d-sm-block" id="navbar-pages">
                  <a class="nav-link dropdown-toggle" data-toggle="dropdown">Pages</a>
                  <ul class="dropdown-menu">
                  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="README.html#design">Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#goals">Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#features">Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="README.html#installation">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="README.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#developing">Developing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="README.html#running-unit-tests">Running unit tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="README.html#getting-started">Getting Started</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="get-started-step-by-step.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="get-started-step-by-step.html#configure-your-home-environment">1. Configure your home environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="get-started-step-by-step.html#a-do-nothing-and-use-your-system-s-current-environment">A) Do nothing and use your system’s current environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="get-started-step-by-step.html#b-explicitly-create-and-edit-your-home-project">B) Explicitly create and edit your home project</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="get-started-step-by-step.html#create-a-project">2. Create a project</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started-step-by-step.html#create-a-service-template">3. Create a service template</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started-step-by-step.html#implementing-an-operation">4. Implementing an operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started-step-by-step.html#activate-your-ensemble">4 Activate your ensemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started-step-by-step.html#publish-your-project">5. Publish your project</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ensembles.html">Ensembles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ensembles.html#repositories-and-history">Repositories and History</a></li>
<li class="toctree-l2"><a class="reference internal" href="ensembles.html#isolation-and-reproducibility">Isolation and Reproducibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="ensembles.html#uris">URIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="ensembles.html#anatomy-of-a-manifest">Anatomy of a Manifest</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Unfurl Projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="projects.html#contexts">Contexts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="projects.html#runtime">Runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects.html#environment">Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects.html#locals">Locals</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects.html#secrets">Secrets</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects.html#external">External</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects.html#inheritance-and-precedence">Inheritance and precedence</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="projects.html#external-ensembles">External ensembles</a></li>
<li class="toctree-l2"><a class="reference internal" href="projects.html#project-defaults">Project defaults</a></li>
<li class="toctree-l2"><a class="reference internal" href="projects.html#runtimes">Runtimes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="secrets.html">Managing Secrets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="secrets.html#sensitive-values">Sensitive Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="secrets.html#creating-secrets">Creating secrets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tosca.html">TOSCA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tosca.html#extensions">Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="tosca.html#not-yet-implemented-and-non-conformance-with-the-tosca-1-3-specification">Not yet implemented and non-conformance with the TOSCA 1.3 specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="tosca.html#extensions-to-built-in-definitions">Extensions to built-in definitions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="jobs.html">Jobs and Workflows</a><ul>
<li class="toctree-l2"><a class="reference internal" href="jobs.html#job-lifecycle">Job Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="jobs.html#operational-status-and-state">Operational status and state</a></li>
<li class="toctree-l2"><a class="reference internal" href="jobs.html#changeids">ChangeIds</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">Runtime Environment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="runtime.html#connections">Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="runtime.html#environment-variables">Environment Variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configurators.html">Configurators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#ansible">Ansible</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#inputs">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#other-implementation-keys">Other <code class="docutils literal notranslate"><span class="pre">implementation</span></code> keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#execution-environment">Execution environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#inventory">Inventory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#delegate">Delegate</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#id1">Inputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#shell">Shell</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#id2">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#result-template-variables">Result template variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#template">Template</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#id3">Inputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#terraform">Terraform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#id4">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#id5">Other <code class="docutils literal notranslate"><span class="pre">implementation</span></code> keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#note-on-hcl-in-yaml">Note on HCL in YAML</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configurators.html#installers">Installers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#docker">Docker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#id7">Inputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#helm">Helm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#unfurl-nodes-helmrelease">unfurl.nodes.HelmRelease</a><ul>
<li class="toctree-l4"><a class="reference internal" href="configurators.html#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="configurators.html#properties">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="configurators.html#id8">Inputs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#unfurl-nodes-helmrepository">unfurl.nodes.HelmRepository</a><ul>
<li class="toctree-l4"><a class="reference internal" href="configurators.html#id9">Properties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#kubernetes">Kubernetes</a></li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#supervisor">Supervisor</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="processing.html">YAML Merge directives</a><ul>
<li class="toctree-l2"><a class="reference internal" href="processing.html#restoring-merge-directives">Restoring merge directives</a><ul>
<li class="toctree-l3"><a class="reference internal" href="processing.html#ansible-jinja2-templates">Ansible Jinja2 Templates</a><ul>
<li class="toctree-l4"><a class="reference internal" href="processing.html#filters">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="processing.html#lookup-plugins">Lookup plugins</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Eval Expressions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#expression-query-syntax">Expression Query Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="#expression-function-syntax">Expression Function Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tosca-functions-and-other-stand-alone-functions">TOSCA functions and other stand-alone functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#concat">concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-artifact">get_artifact</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-attribute">get_attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-env">get_env</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-input">get_input</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-nodes-of-type">get_nodes_of_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-property">get_property</a></li>
<li class="toctree-l3"><a class="reference internal" href="#has-env">has_env</a></li>
<li class="toctree-l3"><a class="reference internal" href="#join">join</a></li>
<li class="toctree-l3"><a class="reference internal" href="#q">q</a></li>
<li class="toctree-l3"><a class="reference internal" href="#token">token</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#expression-functions">Expression Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#abspath">abspath</a></li>
<li class="toctree-l3"><a class="reference internal" href="#and">and</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eq">eq</a></li>
<li class="toctree-l3"><a class="reference internal" href="#external">external</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file">file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-dir">get_dir</a></li>
<li class="toctree-l3"><a class="reference internal" href="#if">if</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lookup">lookup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#local">local</a></li>
<li class="toctree-l3"><a class="reference internal" href="#or">or</a></li>
<li class="toctree-l3"><a class="reference internal" href="#not">not</a></li>
<li class="toctree-l3"><a class="reference internal" href="#secret">secret</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sensitive">sensitive</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tempfile">tempfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#template">template</a></li>
<li class="toctree-l3"><a class="reference internal" href="#validate">validate</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#semantics">Semantics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#special-keys">Special keys</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cli.html#unfurl">unfurl</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-check">check</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-clone">clone</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-commit">commit</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-deploy">deploy</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-discover">discover</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-git">git</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-help">help</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-home">home</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-init">init</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-plan">plan</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-run">run</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-status">status</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-stop">stop</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-undeploy">undeploy</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-version">version</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="jsonschema.html">Configuration Files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="jsonschema.html#files">Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#ensemble-yaml">ensemble.yaml</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#id1">ensemble.yaml</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#job-yaml">job.yaml</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#changelog-yaml">changelog.yaml</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#unfurl-yaml">unfurl.yaml</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#id2">unfurl.yaml</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="jsonschema.html#sections">Sections</a><ul>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#context">context</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#instance">Instance</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#external">External</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#job-record">Job Record</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#task-record">Task Record</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#implementation-definition">implementation definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#changes">Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="jsonschema.html#definitions">Definitions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#enums-and-simple-types">Enums and Simple Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#readystate">readyState</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#state">state</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#changeid">changeId</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#timestamp">Timestamp</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#generic-version-identifier">Generic Version Identifier</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#reusable-helper-definitions">Reusable helper definitions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#instances">instances</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#attributes">attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#atomic">atomic</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#namedobject">namedObject</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#schema">schema</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a><ul>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#tosca-terminology">TOSCA Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#unfurl-specific">Unfurl specific</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Python API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-unfurl.configurator">API for writing configurators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#module-unfurl.runtime">Runtime</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-unfurl.localenv">APIs for controlling Unfurl</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-unfurl.eval">Utility classes and functions</a></li>
</ul>
</li>
</ul>

                  </ul>
              </li>
          </ul>
          <div class="dropdown-divider d-block d-sm-none mb-4"></div>
             
<form class="form-inline" action="search.html" method="get">
  <input type="text" name="q" class="form-control" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <!--<div class="row hidden-sm-up">
          <div class="collapse navbar-toggleable-xs container" id="exCollapsingNavbar2">
              <div class="container">
             　　 <a class="navbar-brand" href="index.html">
                      <img class="logo" src="_static/unfurl_logo.svg" alt="Unfurl"/>
                  </a>
              </div>
              <ul class="nav navbar-nav">
              </ul>
              <div class="dropdown-divider"></div>
              <div class="navbar-text">search<div>
              
<form class="form-inline" action="search.html" method="get">
  <input type="text" name="q" class="form-control" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          </div>
      </div>-->
    </nav>
  </div>

    <div class="related d-flex justify-content-between bg-light flex-wrap" role="navigation" aria-label="related navigation">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="index.html">Unfurl Documentation</a></li>
            <li class="breadcrumb-item active">Eval Expressions</li>
        </ol>
       <div>
          <div class="btn-group btn-group-sm" role="group" aria-label="Basic example">
               <a href="processing.html" title="Previous Chapter: YAML Merge directives" class="btn btn-primary" role="botton" accesskey="P">
                   &laquo; YAML Merge directives
               </a>
               <a href="cli.html" title="Next Chapter: Command Line" class="btn btn-primary" role="botton" accesskey="N">
                   Command Line &raquo;
               </a>
           </div>
       </div>
    </div>

  <div class="main container-fluid">
    <div class="row"> 
      <div class="sphinxsidebar d-none d-md-block">
        <div class="sphinxsidebarwrapper">          
            <h4>Table Of Contents</h4>
            
            
              <div class="sidebartoctree">
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="README.html#design">Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#goals">Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#features">Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="README.html#installation">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="README.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#developing">Developing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="README.html#running-unit-tests">Running unit tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="README.html#getting-started">Getting Started</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="get-started-step-by-step.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="get-started-step-by-step.html#configure-your-home-environment">1. Configure your home environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="get-started-step-by-step.html#a-do-nothing-and-use-your-system-s-current-environment">A) Do nothing and use your system’s current environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="get-started-step-by-step.html#b-explicitly-create-and-edit-your-home-project">B) Explicitly create and edit your home project</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="get-started-step-by-step.html#create-a-project">2. Create a project</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started-step-by-step.html#create-a-service-template">3. Create a service template</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started-step-by-step.html#implementing-an-operation">4. Implementing an operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started-step-by-step.html#activate-your-ensemble">4 Activate your ensemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started-step-by-step.html#publish-your-project">5. Publish your project</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ensembles.html">Ensembles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ensembles.html#repositories-and-history">Repositories and History</a></li>
<li class="toctree-l2"><a class="reference internal" href="ensembles.html#isolation-and-reproducibility">Isolation and Reproducibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="ensembles.html#uris">URIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="ensembles.html#anatomy-of-a-manifest">Anatomy of a Manifest</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Unfurl Projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="projects.html#contexts">Contexts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="projects.html#runtime">Runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects.html#environment">Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects.html#locals">Locals</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects.html#secrets">Secrets</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects.html#external">External</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects.html#inheritance-and-precedence">Inheritance and precedence</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="projects.html#external-ensembles">External ensembles</a></li>
<li class="toctree-l2"><a class="reference internal" href="projects.html#project-defaults">Project defaults</a></li>
<li class="toctree-l2"><a class="reference internal" href="projects.html#runtimes">Runtimes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="secrets.html">Managing Secrets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="secrets.html#sensitive-values">Sensitive Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="secrets.html#creating-secrets">Creating secrets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tosca.html">TOSCA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tosca.html#extensions">Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="tosca.html#not-yet-implemented-and-non-conformance-with-the-tosca-1-3-specification">Not yet implemented and non-conformance with the TOSCA 1.3 specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="tosca.html#extensions-to-built-in-definitions">Extensions to built-in definitions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="jobs.html">Jobs and Workflows</a><ul>
<li class="toctree-l2"><a class="reference internal" href="jobs.html#job-lifecycle">Job Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="jobs.html#operational-status-and-state">Operational status and state</a></li>
<li class="toctree-l2"><a class="reference internal" href="jobs.html#changeids">ChangeIds</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">Runtime Environment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="runtime.html#connections">Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="runtime.html#environment-variables">Environment Variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configurators.html">Configurators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#ansible">Ansible</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#inputs">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#other-implementation-keys">Other <code class="docutils literal notranslate"><span class="pre">implementation</span></code> keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#execution-environment">Execution environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#inventory">Inventory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#delegate">Delegate</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#id1">Inputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#shell">Shell</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#id2">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#result-template-variables">Result template variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#template">Template</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#id3">Inputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#terraform">Terraform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#id4">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#id5">Other <code class="docutils literal notranslate"><span class="pre">implementation</span></code> keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#note-on-hcl-in-yaml">Note on HCL in YAML</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configurators.html#installers">Installers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#docker">Docker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#id7">Inputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#helm">Helm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#unfurl-nodes-helmrelease">unfurl.nodes.HelmRelease</a><ul>
<li class="toctree-l4"><a class="reference internal" href="configurators.html#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="configurators.html#properties">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="configurators.html#id8">Inputs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="configurators.html#unfurl-nodes-helmrepository">unfurl.nodes.HelmRepository</a><ul>
<li class="toctree-l4"><a class="reference internal" href="configurators.html#id9">Properties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#kubernetes">Kubernetes</a></li>
<li class="toctree-l2"><a class="reference internal" href="configurators.html#supervisor">Supervisor</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="processing.html">YAML Merge directives</a><ul>
<li class="toctree-l2"><a class="reference internal" href="processing.html#restoring-merge-directives">Restoring merge directives</a><ul>
<li class="toctree-l3"><a class="reference internal" href="processing.html#ansible-jinja2-templates">Ansible Jinja2 Templates</a><ul>
<li class="toctree-l4"><a class="reference internal" href="processing.html#filters">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="processing.html#lookup-plugins">Lookup plugins</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Eval Expressions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#expression-query-syntax">Expression Query Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="#expression-function-syntax">Expression Function Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tosca-functions-and-other-stand-alone-functions">TOSCA functions and other stand-alone functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#concat">concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-artifact">get_artifact</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-attribute">get_attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-env">get_env</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-input">get_input</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-nodes-of-type">get_nodes_of_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-property">get_property</a></li>
<li class="toctree-l3"><a class="reference internal" href="#has-env">has_env</a></li>
<li class="toctree-l3"><a class="reference internal" href="#join">join</a></li>
<li class="toctree-l3"><a class="reference internal" href="#q">q</a></li>
<li class="toctree-l3"><a class="reference internal" href="#token">token</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#expression-functions">Expression Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#abspath">abspath</a></li>
<li class="toctree-l3"><a class="reference internal" href="#and">and</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eq">eq</a></li>
<li class="toctree-l3"><a class="reference internal" href="#external">external</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file">file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-dir">get_dir</a></li>
<li class="toctree-l3"><a class="reference internal" href="#if">if</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lookup">lookup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#local">local</a></li>
<li class="toctree-l3"><a class="reference internal" href="#or">or</a></li>
<li class="toctree-l3"><a class="reference internal" href="#not">not</a></li>
<li class="toctree-l3"><a class="reference internal" href="#secret">secret</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sensitive">sensitive</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tempfile">tempfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#template">template</a></li>
<li class="toctree-l3"><a class="reference internal" href="#validate">validate</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#semantics">Semantics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#special-keys">Special keys</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cli.html#unfurl">unfurl</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-check">check</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-clone">clone</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-commit">commit</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-deploy">deploy</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-discover">discover</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-git">git</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-help">help</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-home">home</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-init">init</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-plan">plan</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-run">run</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-status">status</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-stop">stop</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-undeploy">undeploy</a></li>
<li class="toctree-l3"><a class="reference internal" href="cli.html#unfurl-version">version</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="jsonschema.html">Configuration Files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="jsonschema.html#files">Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#ensemble-yaml">ensemble.yaml</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#id1">ensemble.yaml</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#job-yaml">job.yaml</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#changelog-yaml">changelog.yaml</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#unfurl-yaml">unfurl.yaml</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#id2">unfurl.yaml</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="jsonschema.html#sections">Sections</a><ul>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#context">context</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#instance">Instance</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#external">External</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#job-record">Job Record</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#task-record">Task Record</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#implementation-definition">implementation definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#changes">Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="jsonschema.html#definitions">Definitions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#enums-and-simple-types">Enums and Simple Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#readystate">readyState</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#state">state</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#changeid">changeId</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#timestamp">Timestamp</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#generic-version-identifier">Generic Version Identifier</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="jsonschema.html#reusable-helper-definitions">Reusable helper definitions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#instances">instances</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#attributes">attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#atomic">atomic</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#namedobject">namedObject</a></li>
<li class="toctree-l4"><a class="reference internal" href="jsonschema.html#schema">schema</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a><ul>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#tosca-terminology">TOSCA Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#unfurl-specific">Unfurl specific</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Python API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-unfurl.configurator">API for writing configurators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#module-unfurl.runtime">Runtime</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-unfurl.localenv">APIs for controlling Unfurl</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-unfurl.eval">Utility classes and functions</a></li>
</ul>
</li>
</ul>

              </div>
            
          
        </div>
      </div> 

      <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="eval-expressions">
<h1><a class="toc-backref" href="#id29">Eval Expressions</a><a class="headerlink" href="#eval-expressions" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#eval-expressions" id="id29">Eval Expressions</a></p>
<ul>
<li><p><a class="reference internal" href="#expression-query-syntax" id="id30">Expression Query Syntax</a></p></li>
<li><p><a class="reference internal" href="#expression-function-syntax" id="id31">Expression Function Syntax</a></p></li>
<li><p><a class="reference internal" href="#tosca-functions-and-other-stand-alone-functions" id="id32">TOSCA functions and other stand-alone functions</a></p>
<ul>
<li><p><a class="reference internal" href="#concat" id="id33">concat</a></p></li>
<li><p><a class="reference internal" href="#get-artifact" id="id34">get_artifact</a></p></li>
<li><p><a class="reference internal" href="#get-attribute" id="id35">get_attribute</a></p></li>
<li><p><a class="reference internal" href="#get-env" id="id36">get_env</a></p></li>
<li><p><a class="reference internal" href="#get-input" id="id37">get_input</a></p></li>
<li><p><a class="reference internal" href="#get-nodes-of-type" id="id38">get_nodes_of_type</a></p></li>
<li><p><a class="reference internal" href="#get-property" id="id39">get_property</a></p></li>
<li><p><a class="reference internal" href="#has-env" id="id40">has_env</a></p></li>
<li><p><a class="reference internal" href="#join" id="id41">join</a></p></li>
<li><p><a class="reference internal" href="#q" id="id42">q</a></p></li>
<li><p><a class="reference internal" href="#token" id="id43">token</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#expression-functions" id="id44">Expression Functions</a></p>
<ul>
<li><p><a class="reference internal" href="#abspath" id="id45">abspath</a></p></li>
<li><p><a class="reference internal" href="#and" id="id46">and</a></p></li>
<li><p><a class="reference internal" href="#eq" id="id47">eq</a></p></li>
<li><p><a class="reference internal" href="#external" id="id48">external</a></p></li>
<li><p><a class="reference internal" href="#file" id="id49">file</a></p></li>
<li><p><a class="reference internal" href="#get-dir" id="id50">get_dir</a></p></li>
<li><p><a class="reference internal" href="#if" id="id51">if</a></p></li>
<li><p><a class="reference internal" href="#lookup" id="id52">lookup</a></p></li>
<li><p><a class="reference internal" href="#local" id="id53">local</a></p></li>
<li><p><a class="reference internal" href="#or" id="id54">or</a></p></li>
<li><p><a class="reference internal" href="#not" id="id55">not</a></p></li>
<li><p><a class="reference internal" href="#secret" id="id56">secret</a></p></li>
<li><p><a class="reference internal" href="#sensitive" id="id57">sensitive</a></p></li>
<li><p><a class="reference internal" href="#tempfile" id="id58">tempfile</a></p></li>
<li><p><a class="reference internal" href="#template" id="id59">template</a></p></li>
<li><p><a class="reference internal" href="#validate" id="id60">validate</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#semantics" id="id61">Semantics</a></p></li>
<li><p><a class="reference internal" href="#special-keys" id="id62">Special keys</a></p></li>
</ul>
</li>
</ul>
</div>
<p>When jobs are run Unfurl expressions that appear in the YAML configuration files are processed.</p>
<div class="section" id="expression-query-syntax">
<h2><a class="toc-backref" href="#id30">Expression Query Syntax</a><a class="headerlink" href="#expression-query-syntax" title="Permalink to this headline">¶</a></h2>
<pre>
<strong id="grammar-token-expr">expr   </strong> ::=  segment? (&quot;::&quot; segment)*
<strong id="grammar-token-segment">segment</strong> ::=  [key] (&quot;[&quot; filter &quot;]&quot;)* [&quot;?&quot;]
<strong id="grammar-token-key">key    </strong> ::=  name | integer | var | &quot;*&quot;
<strong id="grammar-token-filter">filter </strong> ::=  ['!'] [expr] [(&quot;!=&quot; | &quot;=&quot;) test]
<strong id="grammar-token-test">test   </strong> ::=  var | ([^$[]:?])+
<strong id="grammar-token-var">var    </strong> ::=  &quot;$&quot; name
</pre>
</div>
<div class="section" id="expression-function-syntax">
<h2><a class="toc-backref" href="#id31">Expression Function Syntax</a><a class="headerlink" href="#expression-function-syntax" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 41%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>eval</p></td>
<td><p>expr or func</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>vars?</p></td>
<td><p>map</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>select?</p></td>
<td><p>expr</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>foreach?</p></td>
<td><p>{key?, value?}</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>trace?</p></td>
<td><p>integer</p></td>
<td></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="tosca-functions-and-other-stand-alone-functions">
<h2><a class="toc-backref" href="#id32">TOSCA functions and other stand-alone functions</a><a class="headerlink" href="#tosca-functions-and-other-stand-alone-functions" title="Permalink to this headline">¶</a></h2>
<p>Stand-alone functions don’t need to be wrapped in an “eval”</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#concat1"><span class="std std-ref">concat</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">string*</span> <span class="pre">]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#get-artifact1"><span class="std std-ref">get_artifact</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">instance_name,</span> <span class="pre">artifact_name]</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#get-attribute"><span class="std std-ref">get_attribute</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">instance_name,</span> <span class="pre">req_or_cap_name?,</span> <span class="pre">property_name,</span> <span class="pre">index_or_key*</span> <span class="pre">]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#get-env"><span class="std std-ref">get_env</span></a></p></td>
<td><p><code class="regexp docutils literal notranslate"><span class="pre">[</span> <span class="pre">name,</span> <span class="pre">default?</span> <span class="pre">return</span> <span class="pre">]</span> <span class="pre">|</span> <span class="pre">name</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#get-input"><span class="std std-ref">get_input</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">name</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#get-nodes-of-type"><span class="std std-ref">get_nodes_of_type</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">type_name</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#get-property"><span class="std std-ref">get_property</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">instance_name,</span> <span class="pre">req_or_cap_name?,</span> <span class="pre">property_name,</span> <span class="pre">index_or_key*</span> <span class="pre">]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#has-env"><span class="std std-ref">has_env</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">name</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#join"><span class="std std-ref">join</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">string+,</span> <span class="pre">delimiter?</span> <span class="pre">]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#q"><span class="std std-ref">q</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">any</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#token"><span class="std std-ref">token</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">string,</span> <span class="pre">token,</span> <span class="pre">index]</span></code></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="section" id="concat">
<span id="concat1"></span><h3><a class="toc-backref" href="#id33">concat</a><a class="headerlink" href="#concat" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The concat function is used to concatenate two or more string values. See <a class="reference external" href="https://docs.oasis-open.org/tosca/TOSCA-Simple-Profile-YAML/v1.3/os/TOSCA-Simple-Profile-YAML-v1.3-os.html#_Toc454458585">concat</a>.</p>
</div></blockquote>
</div>
<div class="section" id="get-artifact">
<span id="get-artifact1"></span><h3><a class="toc-backref" href="#id34">get_artifact</a><a class="headerlink" href="#get-artifact" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The get_artifact function is used to retrieve artifact location between modelable entities defined in the same service template.</p>
<p>If the artifact is a Docker image, return the image name in the form of
“registry/repository/name:tag” or “registry/repository/name&#64;sha256:digest”</p>
<p>If entity_name or artifact_name is not found return <code class="docutils literal notranslate"><span class="pre">null</span></code>.</p>
<p>See <a class="reference external" href="https://docs.oasis-open.org/tosca/TOSCA-Simple-Profile-YAML/v1.3/os/TOSCA-Simple-Profile-YAML-v1.3-os.html#_Toc26969460">get_artifact</a></p>
</div></blockquote>
</div>
<div class="section" id="get-attribute">
<span id="id3"></span><h3><a class="toc-backref" href="#id35">get_attribute</a><a class="headerlink" href="#get-attribute" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The get_attribute function is used to retrieve the values of named attributes declared by the referenced node or relationship template name.
See <a class="reference external" href="https://docs.oasis-open.org/tosca/TOSCA-Simple-Profile-YAML/v1.3/os/TOSCA-Simple-Profile-YAML-v1.3-os.html#_Toc26969456">TOSCA Attribute Functions</a></p>
</div></blockquote>
</div>
<div class="section" id="get-env">
<span id="id4"></span><h3><a class="toc-backref" href="#id36">get_env</a><a class="headerlink" href="#get-env" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Returns the value of the given environment variable name.
If NAME is not present in the environment, return the given default value if supplied or return None.</p>
<p>e.g. {get_env: NAME} or {get_env: [NAME, default]}</p>
<p>If the value of its argument is empty (e.g. [] or null), return the entire dictionary.</p>
</div></blockquote>
</div>
<div class="section" id="get-input">
<span id="id5"></span><h3><a class="toc-backref" href="#id37">get_input</a><a class="headerlink" href="#get-input" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The get_input function is used to retrieve the values of properties declared within the inputs section of a TOSCA Service Template.
See <a class="reference external" href="https://docs.oasis-open.org/tosca/TOSCA-Simple-Profile-YAML/v1.3/os/TOSCA-Simple-Profile-YAML-v1.3-os.html#_Toc26969456">TOSCA Property Functions</a></p>
</div></blockquote>
</div>
<div class="section" id="get-nodes-of-type">
<span id="id6"></span><h3><a class="toc-backref" href="#id38">get_nodes_of_type</a><a class="headerlink" href="#get-nodes-of-type" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The get_nodes_of_type function can be used to retrieve a list of all known instances of nodes of the declared Node Type.</p>
</div></blockquote>
</div>
<div class="section" id="get-property">
<span id="id7"></span><h3><a class="toc-backref" href="#id39">get_property</a><a class="headerlink" href="#get-property" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The get_property function is used to retrieve property values between modelable entities defined in the same service template.
See <a class="reference external" href="https://docs.oasis-open.org/tosca/TOSCA-Simple-Profile-YAML/v1.3/os/TOSCA-Simple-Profile-YAML-v1.3-os.html#_Toc26969456">TOSCA Property Functions</a></p>
</div></blockquote>
</div>
<div class="section" id="has-env">
<span id="id9"></span><h3><a class="toc-backref" href="#id40">has_env</a><a class="headerlink" href="#has-env" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The <code class="docutils literal notranslate"><span class="pre">has_env</span></code> function returns a boolean indicating whether the given variable is found in the current environment.</p>
</div></blockquote>
</div>
<div class="section" id="join">
<span id="id10"></span><h3><a class="toc-backref" href="#id41">join</a><a class="headerlink" href="#join" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The join function is used to join an array of strings into a single string with optional delimiter. See</p>
</div></blockquote>
</div>
<div class="section" id="q">
<span id="id11"></span><h3><a class="toc-backref" href="#id42">q</a><a class="headerlink" href="#q" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Quote the given value without evaluating it.
For example:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">q</span><span class="p">:</span>
  <span class="nt">eval</span><span class="p">:</span>
     <span class="l l-Scalar l-Scalar-Plain">this will not be evaluated</span>
</pre></div>
</div>
<p>Will evaluate to:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">eval</span><span class="p">:</span>
   <span class="l l-Scalar l-Scalar-Plain">this will not be evaluated</span>
</pre></div>
</div>
<p>without any further evaluation.</p>
</div></blockquote>
</div>
<div class="section" id="token">
<span id="id12"></span><h3><a class="toc-backref" href="#id43">token</a><a class="headerlink" href="#token" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The token function is used on a string to parse out (tokenize) substrings separated by one or more token characters within a larger string.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="expression-functions">
<h2><a class="toc-backref" href="#id44">Expression Functions</a><a class="headerlink" href="#expression-functions" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#abspath"><span class="std std-ref">abspath</span></a></p></td>
<td><p>path | [path, location, mkdir?]</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#and"><span class="std std-ref">and</span></a></p></td>
<td><p>[test+]</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#eq"><span class="std std-ref">eq</span></a></p></td>
<td><p>[a, b]</p></td>
</tr>
<tr class="row-odd"><td><p>external</p></td>
<td><p>name</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#file"><span class="std std-ref">file</span></a></p></td>
<td><p>(see below)</p></td>
</tr>
<tr class="row-odd"><td><p>foreach</p></td>
<td><p>{key?, value?}</p></td>
</tr>
<tr class="row-even"><td><p>get_dir</p></td>
<td><p>location | [location, mkdir?]</p></td>
</tr>
<tr class="row-odd"><td><p>if</p></td>
<td><p>(see below)</p></td>
</tr>
<tr class="row-even"><td><p>local</p></td>
<td><p>name</p></td>
</tr>
<tr class="row-odd"><td><p>lookup</p></td>
<td><p>(see below)</p></td>
</tr>
<tr class="row-even"><td><p>or</p></td>
<td><p>[test+]</p></td>
</tr>
<tr class="row-odd"><td><p>not</p></td>
<td><p>expr</p></td>
</tr>
<tr class="row-even"><td><p>secret</p></td>
<td><p>name</p></td>
</tr>
<tr class="row-odd"><td><p>sensitive</p></td>
<td><p>any</p></td>
</tr>
<tr class="row-even"><td><p>tempfile</p></td>
<td><p>(see below)</p></td>
</tr>
<tr class="row-odd"><td><p>template</p></td>
<td><p>contents</p></td>
</tr>
<tr class="row-even"><td><p>validate</p></td>
<td><p>[contents, schema]</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="section" id="abspath">
<span id="id13"></span><h3><a class="toc-backref" href="#id45">abspath</a><a class="headerlink" href="#abspath" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">name</dt>
<dd class="field-odd"><p>a named folder</p>
</dd>
</dl>
<p>Get the absolute path.
Also available as a jinja2 filter.</p>
</div></blockquote>
</div>
<div class="section" id="and">
<span id="id14"></span><h3><a class="toc-backref" href="#id46">and</a><a class="headerlink" href="#and" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Evaluates each expression in the list until an expression evaluates as false and
returns the result of the last expression evaluated.</p>
</div></blockquote>
</div>
<div class="section" id="eq">
<span id="id15"></span><h3><a class="toc-backref" href="#id47">eq</a><a class="headerlink" href="#eq" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="external">
<span id="id16"></span><h3><a class="toc-backref" href="#id48">external</a><a class="headerlink" href="#external" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Return an instance</p>
</div></blockquote>
</div>
<div class="section" id="file">
<span id="id17"></span><h3><a class="toc-backref" href="#id49">file</a><a class="headerlink" href="#file" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Read or write a file
<code class="docutils literal notranslate"><span class="pre">encoding</span></code> can be “binary”, “vault”, “json”, “yaml” or an encoding registered with the Python codec registry</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">eval</span><span class="p">:</span>
  <span class="nt">file</span><span class="p">:</span>
  <span class="nt">contents</span><span class="p">:</span>
<span class="nt">select</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">contents</span>
</pre></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>file:</p></td>
<td><p>path</p></td>
</tr>
<tr class="row-odd"><td><p>encoding?</p></td>
<td><p>“binary” | “vault” | “json” | “yaml” | python_text_encoding</p></td>
</tr>
<tr class="row-even"><td><p>contents?</p></td>
<td><p>any</p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">encoding</span></code> can be “binary”, “vault”, “json”, “yaml” or an encoding registered with the Python codec registry</p>
<p>Key can be one of:</p>
<p>path # absolute path
contents # file contents (None if it doesn’t exist)
encoding</p>
</div></blockquote>
</div>
<div class="section" id="get-dir">
<span id="id18"></span><h3><a class="toc-backref" href="#id50">get_dir</a><a class="headerlink" href="#get-dir" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Return an absolute path to the given named folder where <code class="docutils literal notranslate"><span class="pre">name</span></code> is one of:</p>
<dl class="field-list simple">
<dt class="field-odd">.</dt>
<dd class="field-odd"><p>directory that contains the current instance’s the ensemble</p>
</dd>
<dt class="field-even">src</dt>
<dd class="field-even"><p>directory of the source file this expression appears in</p>
</dd>
<dt class="field-odd">home</dt>
<dd class="field-odd"><p>The “home” directory for the current instance (committed to repository)</p>
</dd>
<dt class="field-even">local</dt>
<dd class="field-even"><p>The “local” directory for the current instance (excluded from repository)</p>
</dd>
<dt class="field-odd">tmp</dt>
<dd class="field-odd"><p>A temporary directory (removed after unfurl exits)</p>
</dd>
<dt class="field-even">spec.src</dt>
<dd class="field-even"><p>The directory of the source file the current instance’s template appears in.</p>
</dd>
<dt class="field-odd">spec.home</dt>
<dd class="field-odd"><p>The “home” directory of the source file the current instance’s template.</p>
</dd>
<dt class="field-even">spec.local</dt>
<dd class="field-even"><p>The “local” directory of the source file the current instance’s template.</p>
</dd>
</dl>
<p>Otherwise look for a repository with the given name and return its path or None if not found.</p>
</div></blockquote>
</div>
<div class="section" id="if">
<span id="id19"></span><h3><a class="toc-backref" href="#id51">if</a><a class="headerlink" href="#if" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>if</p></td>
<td><p>mapped_value</p></td>
</tr>
<tr class="row-odd"><td><p>then?</p></td>
<td><p>expr</p></td>
</tr>
<tr class="row-even"><td><p>else?</p></td>
<td><p>expr</p></td>
</tr>
</tbody>
</table>
<p>Example: this will always evaluate to “expected”:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">eval</span><span class="p">:</span>
  <span class="nt">if</span><span class="p">:</span>
    <span class="nt">or</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">not</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">$a</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">$a</span>
  <span class="nt">then</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">expected</span>
  <span class="nt">else</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">unexpected</span>
<span class="nt">vars</span><span class="p">:</span>
  <span class="nt">a</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="lookup">
<span id="id20"></span><h3><a class="toc-backref" href="#id52">lookup</a><a class="headerlink" href="#lookup" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>lookup</p></td>
<td><p>{name: args,
kwargs*: value}</p></td>
</tr>
</tbody>
</table>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">eval</span><span class="p">:</span>
  <span class="nt">lookup</span><span class="p">:</span>
    <span class="nt">env</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">TEST_ENV</span>

<span class="nt">eval</span><span class="p">:</span>
  <span class="nt">lookup</span><span class="p">:</span>
    <span class="nt">env</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">TEST_ENV</span><span class="p p-Indicator">,</span> <span class="nv">default</span><span class="p p-Indicator">]</span>

<span class="nt">eval</span><span class="p">:</span>
  <span class="nt">lookup</span><span class="p">:</span>
    <span class="nt">url</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example.com/foo.txt</span>
    <span class="nt">validate_certs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="local">
<span id="id21"></span><h3><a class="toc-backref" href="#id53">local</a><a class="headerlink" href="#local" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="or">
<span id="id22"></span><h3><a class="toc-backref" href="#id54">or</a><a class="headerlink" href="#or" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Evaluates each item until an item evaluates as true, returns that value or false.</p>
</div></blockquote>
</div>
<div class="section" id="not">
<span id="id23"></span><h3><a class="toc-backref" href="#id55">not</a><a class="headerlink" href="#not" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="secret">
<span id="id24"></span><h3><a class="toc-backref" href="#id56">secret</a><a class="headerlink" href="#secret" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Return the value of the given secret. It will be marked as sensitive.</p>
</div></blockquote>
</div>
<div class="section" id="sensitive">
<span id="id25"></span><h3><a class="toc-backref" href="#id57">sensitive</a><a class="headerlink" href="#sensitive" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Mark the given value as sensitive.</p>
</div></blockquote>
</div>
<div class="section" id="tempfile">
<span id="id26"></span><h3><a class="toc-backref" href="#id58">tempfile</a><a class="headerlink" href="#tempfile" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Create local, temporary file with the specified content.
It will be deleted after <code class="docutils literal notranslate"><span class="pre">unfurl</span></code> process exits.</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">eval</span><span class="p">:</span>
  <span class="nt">tempfile</span><span class="p">:</span> <span class="s">&quot;contents&quot;</span>
  <span class="nt">encoding</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vault</span>
  <span class="nt">suffix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.json</span>
</pre></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>tempfile</p></td>
<td><p>contents</p></td>
</tr>
<tr class="row-odd"><td><p>encoding?</p></td>
<td><p>“binary” | “vault” | “json” | “yaml” | python_text_encoding</p></td>
</tr>
<tr class="row-even"><td><p>suffix?</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>If <code class="docutils literal notranslate"><span class="pre">encoding</span></code> isn’t specified, the file extension specified by <code class="docutils literal notranslate"><span class="pre">suffix</span></code> is used;
if neither is specified, the encoding will be determined by the content, either utf8 text, binary or json or a 0 byte file if the content is null.</p>
</div></blockquote>
</div>
<div class="section" id="template">
<span id="id27"></span><h3><a class="toc-backref" href="#id59">template</a><a class="headerlink" href="#template" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Evaluate contents as an Ansible-flavored Jinja2 template</p>
</div></blockquote>
</div>
<div class="section" id="validate">
<span id="id28"></span><h3><a class="toc-backref" href="#id60">validate</a><a class="headerlink" href="#validate" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Return true if the first argument conforms to the JSON schema supplied as the second argument.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="semantics">
<h2><a class="toc-backref" href="#id61">Semantics</a><a class="headerlink" href="#semantics" title="Permalink to this headline">¶</a></h2>
<p>Each segment specifies a key in a resource or JSON/YAML object.
“::” is used as the segment delimitated to allow for keys that contain “.” and “/”</p>
<p>Path expressions evaluations always start with a list of one or more Resources.
and each segment selects the value associated with that key.
If segment has one or more filters
each filter is applied to that value – each is treated as a predicate
that decides whether value is included or not in the results.
If the filter doesn’t include a test the filter tests the existence or non-existence of the expression,
depending on whether the expression is prefixed with a “!”.
If the filter includes a test the left side of the test needs to match the right side.
If the right side is not a variable, that string will be coerced to left side’s type before comparing it.
If the left-side expression is omitted, the value of the segment’s key is used and if that is missing, the current value is used.</p>
<p>If the current value is a list and the key looks like an integer
it will be treated like a zero-based index into the list.
Otherwise the segment is evaluated again all values in the list and resulting value is a list.
If the current value is a dictionary and the key is “*”, all values will be selected.</p>
<p>If a segment ends in “?”, it will only include the first match.
In other words, “a?::b::c” is a shorthand for “a[b::c]::0::b::c”.
This is useful to guarantee the result of evaluating expression is always a single result.</p>
<p>The first segment:
If the first segment is a variable reference the current value is set to that variable’s value.
If the key in the first segment is empty (e.g. the expression starts with ‘::’) the current value will be set to the evaluation of ‘.all’.
If the key in the first segment starts with ‘.’ it is evaluated against the initial “current resource”.
Otherwise, the current value is set to the evaluation of “.ancestors?”. In other words,
the expression will be the result of evaluating it against the first ancestor of the current resource that it matches.</p>
<p>If key or test needs to be a non-string type or contains a unallowed character use a var reference instead.</p>
<p>When multiple steps resolve to lists the resultant lists are flattened.
However if the final set of matches contain values that are lists those values are not flattened.</p>
<p>For example, given:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="p">[</span> <span class="p">{</span>
        <span class="nx">a</span><span class="o">:</span> <span class="p">[{</span><span class="nx">c</span><span class="o">:</span><span class="mf">1</span><span class="p">},</span> <span class="p">{</span><span class="nx">c</span><span class="o">:</span><span class="mf">2</span><span class="p">}]</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nx">a</span><span class="o">:</span> <span class="p">[{</span><span class="nx">c</span><span class="o">:</span><span class="mf">3</span><span class="p">},</span> <span class="p">{</span><span class="nx">c</span><span class="o">:</span><span class="mf">4</span><span class="p">}]</span>
      <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">x:a:c</span></code> resolves to:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">[1,2,3,4]</span></code></p>
</dd>
<dt>not</dt><dd><p><code class="docutils literal notranslate"><span class="pre">[[1,2],</span> <span class="pre">[3,4]])</span></code></p>
</dd>
</dl>
<p>(Justification: It is inconvenient and fragile to tie data structures to the particular form of a query.
If you want preserve structure (e.g. to know which values are part
of which parent value or resource) use a less deep path and iterate over results.)</p>
</div>
<div class="section" id="special-keys">
<h2><a class="toc-backref" href="#id62">Special keys</a><a class="headerlink" href="#special-keys" title="Permalink to this headline">¶</a></h2>
<p>Built-in keys start with a leading <strong>.</strong>:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>.</strong></p></td>
<td><p>self</p></td>
</tr>
<tr class="row-even"><td><p><strong>..</strong></p></td>
<td><p>parent</p></td>
</tr>
<tr class="row-odd"><td><p>.name</p></td>
<td><p>name of this instance</p></td>
</tr>
<tr class="row-even"><td><p>.type</p></td>
<td><p>name of instance’s TOSCA type</p></td>
</tr>
<tr class="row-odd"><td><p>.parents</p></td>
<td><p>list of parents</p></td>
</tr>
<tr class="row-even"><td><p>.ancestors</p></td>
<td><p>self and parents</p></td>
</tr>
<tr class="row-odd"><td><p>.root</p></td>
<td><p>root ancestor</p></td>
</tr>
<tr class="row-even"><td><p>.instances</p></td>
<td><p>child instances (via the <code class="docutils literal notranslate"><span class="pre">hostedOn</span></code> relationship)</p></td>
</tr>
<tr class="row-odd"><td><p>.capabilities</p></td>
<td><p>list of capabilities</p></td>
</tr>
<tr class="row-even"><td><p>.requirements</p></td>
<td><p>list of requirements</p></td>
</tr>
<tr class="row-odd"><td><p>.relationships</p></td>
<td><p>relationships that target this capability</p></td>
</tr>
<tr class="row-even"><td><p>.descendents</p></td>
<td><p>(including self)</p></td>
</tr>
<tr class="row-odd"><td><p>.all</p></td>
<td><p>dictionary of child resources with their names as keys</p></td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
    </div>
      <div class="clearer"></div>
      </div>
    </div>
<footer class="footer d-flex justify-content-between flex-wrap">
    <div class="copyright">
        <div>&copy; Copyright 2020, Adam Souzis.</div>
      <div>Generated by <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.3.1 using <a href="https://github.com/myyasuda/sphinxbootstrap4theme">sphinxbootstrap4theme</a> 0.6.0.</div>
    </div>
    <div>
        <a href="#" class="btn btn-primary btn-sm" role="botton">Back to top</a>
    </div>
</footer>
  </body>
</html>